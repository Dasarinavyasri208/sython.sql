
Q1 = '''SELECT  P.PLAYER_ID, MC.TEAM_ID, P.JERSEY_NO, P.NAME,P.DATE_OF_BIRTH, P.AGE 
FROM MATCHCAPTAIN AS MC JOIN PLAYER AS P ON MC.CAPTAIN = P.PLAYER_ID
left JOIN GOALDETAILS AS GD ON GD.PLAYER_ID = MC.CAPTAIN
WHERE GOAL_ID IS NULL'''

Q2 = '''SELECT TEAM_ID,COUNT(MATCH_NO) FROM MATCHCAPTAIN 
GROUP BY TEAM_ID;'''

Q3 = '''SELECT GD.TEAM_ID, COUNT(GD.GOAL_ID) * 1.0 / (SELECT COUNT(P.PLAYER_ID) FROM PLAYER P WHERE P.TEAM_ID = GD.TEAM_ID)
FROM GOALDETAILS GD
GROUP BY GD.TEAM_ID;'''

Q4 = '''SELECT CAPTAIN , COUNT(CAPTAIN) AS no_of_times_captain 
FROM MATCHCAPTAIN JOIN PLAYER AS P 
WHERE CAPTAIN = P.PLAYER_ID
GROUP BY CAPTAIN;'''


Q5 = '''SELECT COUNT(DISTINCT CAPTAIN) AS NO_PLAYERS FROM MATCHCAPTAIN AS MC
JOIN MATCH AS M ON MC.MATCH_NO = M.MATCH_NO AND MC.CAPTAIN = M.PLAYER_OF_MATCH;'''


Q6 = '''SELECT DISTINCT CAPTAIN FROM MATCHCAPTAIN MC
WHERE  EXISTS (
    SELECT PLAYER_ID FROM PLAYER 
    WHERE PLAYER_ID = CAPTAIN
    )
AND NOT EXISTS (
    SELECT M.MATCH_NO FROM MATCH M JOIN MATCHCAPTAIN MC_1
    ON MC_1.MATCH_NO = M.MATCH_NO AND MC.CAPTAIN = PLAYER_OF_MATCH); '''


Q7 = '''SELECT STRFTIME("%m",PLAY_DATE) AS MONTH, COUNT(MATCH_NO) AS NO_OF_MATCHES
FROM MATCH 
GROUP BY MONTH
ORDER BY NO_OF_MATCHES DESC;'''

Q8 = '''SELECT JERSEY_NO,COUNT(CAPTAIN) AS NO_CAPTAINS FROM MATCHCAPTAIN MC
JOIN PLAYER P ON MC.CAPTAIN = P.PLAYER_ID
GROUP BY JERSEY_NO
ORDER BY NO_CAPTAINS DESC, JERSEY_NO DESC;'''

Q9 = '''SELECT P.PLAYER_ID, AVG(AUDIENCE) AS AVG_AUDIENCE
FROM PLAYER P JOIN MATCHCAPTAIN MC 
ON MC.TEAM_ID = P.TEAM_ID 
JOIN MATCH M ON M.MATCH_NO = MC.MATCH_NO
GROUP BY P.PLAYER_ID
ORDER BY AVG_AUDIENCE DESC, P.PLAYER_ID DESC;'''

Q10 = '''SELECT team_id, AVG(AGE) FROM PLAYER P 
GROUP BY TEAM_ID;'''

Q11 = '''SELECT AVG(P.AGE) FROM MATCHCAPTAIN MC JOIN PLAYER P 
ON P.TEAM_ID = MC.TEAM_ID 
WHERE P.PLAYER_ID = MC.CAPTAIN;'''

Q12 = '''SELECT STRFTIME("%m",DATE_OF_BIRTH) AS MONTH ,COUNT(P.PLAYER_ID) AS no_of_players 
FROM PLAYER P 
GROUP BY MONTH
ORDER BY no_of_players DESC, MONTH DESC;'''

Q13 = '''SELECT CAPTAIN ,COUNT(win_lose) NO_OF_WINS FROM MATCHTEAMDETAILS MTD 
JOIN MATCHCAPTAIN MC ON MTD.MATCH_NO = MC.MATCH_NO 
WHERE WIN_LOSE ="W" AND MTD.TEAM_ID = MC.TEAM_ID
GROUP BY CAPTAIN
ORDER BY  NO_OF_WINS DESC;'''
